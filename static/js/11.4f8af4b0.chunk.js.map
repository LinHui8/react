{"version":3,"sources":["pages/Rent/Search/index.module.css","pages/Rent/Search/index.js"],"names":["module","exports","Search","cityId","getCity","value","timerId","state","searchTxt","tipsList","onTipsClick","item","props","history","replace","name","communityName","id","community","renderTips","map","key","className","styles","tip","onClick","handleSearchTxt","setState","clearTimeout","setTimeout","a","API","get","params","res","data","body","this","root","placeholder","onChange","showCancelButton","onCancel","tips","Component"],"mappings":"oFACAA,EAAOC,QAAU,CAAC,KAAO,qBAAqB,KAAO,qBAAqB,UAAY,0BAA0B,KAAO,qBAAqB,IAAM,sB,uMCO7HC,E,2MAEnBC,OAASC,cAAUC,M,EAEnBC,QAAU,K,EAEVC,MAAQ,CAENC,UAAW,GACXC,SAAU,I,EAcZC,YAAc,SAAAC,GACZ,EAAKC,MAAMC,QAAQC,QAAQ,YAAa,CACtCC,KAAMJ,EAAKK,cACXC,GAAIN,EAAKO,a,EAKbC,WAAa,WAGX,OAFqB,EAAKZ,MAAlBE,SAEQW,KAAI,SAAAT,GAAI,OACtB,wBACEU,IAAKV,EAAKO,UACVI,UAAWC,IAAOC,IAClBC,QAAS,kBAAM,EAAKf,YAAYC,KAE/BA,EAAKK,mB,EAQZU,gBAAkB,SAAArB,GAGhB,GAFA,EAAKsB,SAAS,CAAEnB,UAAWH,KAEtBA,EAEH,OAAO,EAAKsB,SAAS,CACnBlB,SAAU,KAKdmB,aAAa,EAAKtB,SAElB,EAAKA,QAAUuB,WAAU,sBAAC,4BAAAC,EAAA,sEAENC,IAAIC,IAAI,kBAAmB,CAC3CC,OAAQ,CACNlB,KAAMV,EACNY,GAAI,EAAKd,UALW,OAElB+B,EAFkB,OAWxB,EAAKP,SAAS,CACZlB,SAAUyB,EAAIC,KAAKC,OAZG,2CAcvB,M,wEAGK,IACAvB,EAAYwB,KAAKzB,MAAjBC,QACAL,EAAc6B,KAAK9B,MAAnBC,UAER,OACE,yBAAKc,UAAWC,IAAOe,MAErB,kBAAC,IAAD,CACEC,YAAY,mDACZlC,MAAOG,EACPgC,SAAUH,KAAKX,gBACfe,kBAAkB,EAClBC,SAAU,kBAAM7B,EAAQC,QAAQ,gBAIlC,wBAAIQ,UAAWC,IAAOoB,MAAON,KAAKlB,mB,GA9FNyB","file":"static/js/11.4f8af4b0.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"Search_root__rBd4l\",\"list\":\"Search_list__2yT8q\",\"noHistory\":\"Search_noHistory__2ATCP\",\"tips\":\"Search_tips__myu6f\",\"tip\":\"Search_tip__2YD8m\"};","import React, { Component } from 'react'\r\n\r\nimport { SearchBar } from 'antd-mobile'\r\n\r\nimport { getCity, API } from '../../../utils'\r\n\r\nimport styles from './index.module.css'\r\n\r\nexport default class Search extends Component {\r\n  // 当前城市id\r\n  cityId = getCity().value\r\n  // 定时器id\r\n  timerId = null\r\n\r\n  state = {\r\n    // 搜索框的值\r\n    searchTxt: '',\r\n    tipsList: []\r\n  }\r\n\r\n  /* \r\n    传递小区数据：\r\n\r\n    1 给搜索列表项添加单击事件。\r\n    2 在事件处理程序中，调用 history.replace() 方法跳转到发布房源页面。\r\n    3 将被点击的小区信息作为数据一起传递过去。\r\n\r\n    4 在发布房源页面，判断 history.loaction.state 是否为空。\r\n    5 如果为空，不做任何处理。\r\n    6 如果不为空，则将小区信息存储到发布房源页面的状态中。\r\n  */\r\n  onTipsClick = item => {\r\n    this.props.history.replace('/rent/add', {\r\n      name: item.communityName,\r\n      id: item.community\r\n    })\r\n  }\r\n\r\n  // 渲染搜索结果列表\r\n  renderTips = () => {\r\n    const { tipsList } = this.state\r\n\r\n    return tipsList.map(item => (\r\n      <li\r\n        key={item.community}\r\n        className={styles.tip}\r\n        onClick={() => this.onTipsClick(item)}\r\n      >\r\n        {item.communityName}\r\n      </li>\r\n    ))\r\n  }\r\n\r\n  /* \r\n    关键词搜索小区信息\r\n  */\r\n  handleSearchTxt = value => {\r\n    this.setState({ searchTxt: value })\r\n\r\n    if (!value) {\r\n      // 文本框的值为空\r\n      return this.setState({\r\n        tipsList: []\r\n      })\r\n    }\r\n\r\n    // 清除上一次的定时器\r\n    clearTimeout(this.timerId)\r\n\r\n    this.timerId = setTimeout(async () => {\r\n      // 获取小区数据\r\n      const res = await API.get('/area/community', {\r\n        params: {\r\n          name: value,\r\n          id: this.cityId\r\n        }\r\n      })\r\n\r\n      // console.log(res)\r\n\r\n      this.setState({\r\n        tipsList: res.data.body\r\n      })\r\n    }, 500)\r\n  }\r\n\r\n  render() {\r\n    const { history } = this.props\r\n    const { searchTxt } = this.state\r\n\r\n    return (\r\n      <div className={styles.root}>\r\n        {/* 搜索框 */}\r\n        <SearchBar\r\n          placeholder=\"请输入小区或地址\"\r\n          value={searchTxt}\r\n          onChange={this.handleSearchTxt}\r\n          showCancelButton={true}\r\n          onCancel={() => history.replace('/rent/add')}\r\n        />\r\n\r\n        {/* 搜索提示列表 */}\r\n        <ul className={styles.tips}>{this.renderTips()}</ul>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n"],"sourceRoot":""}