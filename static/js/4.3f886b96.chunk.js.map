{"version":3,"sources":["components/NavHeader/index.js","components/NavHeader/index.module.css","components/HousePackage/index.js","components/HousePackage/index.module.css","pages/HouseDetail/index.module.css","pages/HouseDetail/index.js"],"names":["withRouter","children","history","onLeftClick","className","rightContent","styles","navBar","join","mode","icon","go","module","exports","HOUSE_PACKAGE","id","name","HousePackage","state","selectedNames","toggleSelect","newSelectedNames","indexOf","filter","item","props","onSelect","setState","this","select","list","v","includes","map","isSelected","key","active","onClick","root","renderItems","Component","defaultProps","recommendHouses","src","BASE_URL","desc","title","price","tags","BMap","window","labelStyle","position","zIndex","backgroundColor","color","height","padding","lineHeight","borderRadius","boxShadow","whiteSpace","fontSize","userSelect","alert","Modal","HouseDetail","isLoading","houseInfo","houseImg","roomType","size","oriented","floor","community","coord","latitude","longitude","supporting","houseCode","description","isFavorite","handleFavorite","a","isLogin","isAuth","location","match","text","onPress","replace","from","params","API","delete","res","data","status","Toast","info","post","getHouseDetail","checkFavorite","get","body","renderMap","href","alt","Map","point","Point","centerAndZoom","label","Label","offset","Size","setStyle","setContent","mapArrow","addOverlay","index","tagClass","tag","navHeader","slides","autoplay","infinite","autoplayInterval","renderSwipers","infoTitle","Item","renderTags","infoPrice","infoPriceItem","month","infoBasic","align","mapTitle","mapContainer","about","houseTitle","length","titleEmpty","set","contact","user","useInfo","userAuth","userMsg","descText","recommend","items","fixedBottom","favoriteImg","favorite","telephone"],"mappings":"gGAAA,sDA+CeA,iBAhCf,YAMI,IALFC,EAKC,EALDA,SACAC,EAIC,EAJDA,QACAC,EAGC,EAHDA,YACAC,EAEC,EAFDA,UACAC,EACC,EADDA,aAKA,OACE,kBAAC,IAAD,CACED,UAAW,CAACE,IAAOC,OAAQH,GAAa,IAAII,KAAK,KACjDC,KAAK,QACLC,KAAM,uBAAGN,UAAU,uBACnBD,YAAaA,GAPM,kBAAMD,EAAQS,IAAI,IAQrCN,aAAcA,GAEbJ,O,oBChCPW,EAAOC,QAAU,CAAC,OAAS,4B,wHCIrBC,EAAgB,CACpB,CACEC,GAAI,EACJC,KAAM,eACNN,KAAM,iBAER,CACEK,GAAI,EACJC,KAAM,qBACNN,KAAM,aAER,CACEK,GAAI,EACJC,KAAM,eACNN,KAAM,YAER,CACEK,GAAI,EACJC,KAAM,qBACNN,KAAM,YAER,CACEK,GAAI,EACJC,KAAM,eACNN,KAAM,YAER,CACEK,GAAI,EACJC,KAAM,eACNN,KAAM,aAER,CACEK,GAAI,EACJC,KAAM,eACNN,KAAM,YAER,CACEK,GAAI,EACJC,KAAM,qBACNN,KAAM,eAER,CACEK,GAAI,EACJC,KAAM,eACNN,KAAM,kBAER,CACEK,GAAI,GACJC,KAAM,eACNN,KAAM,cAWJO,E,2MACJC,MAAQ,CAENC,cAAe,I,EAIjBC,aAAe,SAAAJ,GAAS,IAElBK,EADIF,EAAkB,EAAKD,MAAvBC,cAMNE,EAFEF,EAAcG,QAAQN,IAAS,EAEdG,EAAcI,QAAO,SAAAC,GAAI,OAAIA,IAASR,KAGzC,sBAAOG,GAAP,CAAsBH,IAIxC,EAAKS,MAAMC,SAASL,GAEpB,EAAKM,SAAS,CACZR,cAAeE,K,6EAKJ,IAAD,OACJF,EAAkBS,KAAKV,MAAvBC,cADI,EAIaS,KAAKH,MAAtBI,EAJI,EAIJA,OAAQC,EAJJ,EAIIA,KAahB,OARID,EACKf,EAIAA,EAAcS,QAAO,SAAAQ,GAAC,OAAID,EAAKE,SAASD,EAAEf,UAGvCiB,KAAI,SAAAT,GAEd,IAAMU,EAAaf,EAAcG,QAAQE,EAAKR,OAAS,EAEvD,OACE,wBACEmB,IAAKX,EAAKT,GACVX,UAAW,CAACE,IAAOkB,KAAMU,EAAa5B,IAAO8B,OAAS,IAAI5B,KAAK,KAC/D6B,QAASR,GAAW,kBAAM,EAAKT,aAAaI,EAAKR,QAEjD,2BACE,uBAAGZ,UAAS,mBAAcoB,EAAKd,KAAnB,YAA2BJ,IAAOI,SAE/Cc,EAAKR,W,+BAOZ,OAAO,wBAAIZ,UAAWE,IAAOgC,MAAOV,KAAKW,mB,GAlElBC,aAuE3BvB,EAAawB,aAAe,CAC1Bf,SAAU,cAGGT,O,oBC3IfL,EAAOC,QAAU,CAAC,KAAO,2BAA2B,KAAO,2BAA2B,OAAS,6BAA6B,KAAO,6B,oBCAnID,EAAOC,QAAU,CAAC,KAAO,0BAA0B,OAAS,4BAA4B,UAAY,+BAA+B,KAAO,0BAA0B,UAAY,+BAA+B,KAAO,0BAA0B,IAAM,yBAAyB,KAAO,0BAA0B,KAAO,0BAA0B,KAAO,0BAA0B,UAAY,+BAA+B,cAAgB,mCAAmC,MAAQ,2BAA2B,UAAY,+BAA+B,MAAQ,2BAA2B,IAAM,yBAAyB,SAAW,8BAA8B,aAAe,kCAAkC,SAAW,8BAA8B,WAAa,gCAAgC,MAAQ,2BAA2B,IAAM,yBAAyB,WAAa,gCAAgC,QAAU,6BAA6B,KAAO,0BAA0B,QAAU,6BAA6B,SAAW,8BAA8B,QAAU,6BAA6B,SAAW,8BAA8B,UAAY,+BAA+B,MAAQ,2BAA2B,YAAc,iCAAiC,SAAW,8BAA8B,YAAc,iCAAiC,UAAY,iC,kOCcl0C6B,EAAkB,CACtB,CACE3B,GAAI,EACJ4B,IAAKC,IAAW,qBAChBC,KAAM,+CACNC,MAAO,0CACPC,MAAO,KACPC,KAAM,CAAC,6BAET,CACEjC,GAAI,EACJ4B,IAAKC,IAAW,qBAChBC,KAAM,qCACNC,MAAO,oCACPC,MAAO,KACPC,KAAM,CAAC,uBAET,CACEjC,GAAI,EACJ4B,IAAKC,IAAW,qBAChBC,KAAM,2CACNC,MAAO,iDACPC,MAAO,KACPC,KAAM,CAAC,8BAKLC,EAAOC,OAAOD,KAEdE,EAAa,CACjBC,SAAU,WACVC,QAAS,QACTC,gBAAiB,mBACjBC,MAAO,qBACPC,OAAQ,GACRC,QAAS,WACTC,WAAY,OACZC,aAAc,EACdC,UAAW,iCACXC,WAAY,SACZC,SAAU,GACVC,WAAY,QAGRC,EAAQC,IAAMD,MAECE,E,2MACnBhD,MAAQ,CAENiD,WAAW,EAGXC,UAAW,CAETC,SAAU,GAEVvB,MAAO,GAEPE,KAAM,GAEND,MAAO,EAEPuB,SAAU,GAEVC,KAAM,EAENC,SAAU,GAEVC,MAAO,GAEPC,UAAW,GAEXC,MAAO,CACLC,SAAU,YACVC,UAAW,cAGbC,WAAY,GAEZC,UAAW,GAEXC,YAAa,IAIfC,YAAY,G,EA2DdC,e,sBAAiB,0CAAAC,EAAA,yDACTC,EAAUC,cADD,EAEsB,EAAK5D,MAAlCvB,EAFO,EAEPA,QAASoF,EAFF,EAEEA,SAAUC,EAFZ,EAEYA,MAEtBH,EAJU,yCAMNpB,EAAM,eAAM,8FAAoB,CACrC,CAAEwB,KAAM,gBACR,CACEA,KAAM,qBAINC,QAAS,kBAAMvF,EAAQwF,QAAQ,SAAU,CAAEC,KAAML,SAbxC,UAmBPL,EAAe,EAAK/D,MAApB+D,WACAlE,EAAOwE,EAAMK,OAAb7E,IAEJkE,EAtBW,iCAwBKY,IAAIC,OAAJ,0BAA8B/E,IAxBnC,OAwBPgF,EAxBO,OA0Bb,EAAKpE,SAAS,CACZsD,YAAY,IAGU,MAApBc,EAAIC,KAAKC,OAEXC,IAAMC,KAAK,iCAAS,EAAG,MAAM,GAG7BD,IAAMC,KAAK,+DAAc,EAAG,MAAM,GAnCvB,yCAuCKN,IAAIO,KAAJ,0BAA4BrF,IAvCjC,QAyCW,MAzCX,OAyCLiF,KAAKC,QAEXC,IAAMC,KAAK,qBAAO,EAAG,MAAM,GAC3B,EAAKxE,SAAS,CACZsD,YAAY,KAIdiB,IAAMC,KAAK,+DAAc,EAAG,MAAM,GAjDvB,4C,mFAlDfvE,KAAKyE,iBAGLzE,KAAK0E,kB,iKAKWjB,c,wDAQRtE,EAAOa,KAAKH,MAAM8D,MAAMK,OAAxB7E,G,SACU8E,IAAIU,IAAJ,0BAA2BxF,I,OAAvCgF,E,SAEmBA,EAAIC,KAArBC,E,EAAAA,OAAQO,E,EAAAA,KACD,MAAXP,GAEFrE,KAAKD,SAAS,CACZsD,WAAYuB,EAAKvB,a,4QAmFblE,EAAOa,KAAKH,MAAM8D,MAAMK,OAAxB7E,GAGRa,KAAKD,SAAS,CACZwC,WAAW,I,SAGK0B,IAAIU,IAAJ,kBAAmBxF,I,OAA/BgF,E,OAINnE,KAAKD,SAAS,CACZyC,UAAW2B,EAAIC,KAAKQ,KACpBrC,WAAW,I,EAGgB4B,EAAIC,KAAKQ,KAA9B9B,E,EAAAA,UAAWC,E,EAAAA,MAGnB/C,KAAK6E,UAAU/B,EAAWC,G,4IAS1B,OAFI/C,KAAKV,MADPkD,UAAaC,SAGCpC,KAAI,SAAAT,GAAI,OACtB,uBAAGW,IAAKX,EAAMkF,KAAK,oBACjB,yBAAK/D,IAAKC,IAAWpB,EAAMmF,IAAI,W,gCAM3BjC,EAAWC,GAAQ,IACnBC,EAAwBD,EAAxBC,SAAUC,EAAcF,EAAdE,UAEZ5C,EAAM,IAAIgB,EAAK2D,IAAI,OACnBC,EAAQ,IAAI5D,EAAK6D,MAAMjC,EAAWD,GACxC3C,EAAI8E,cAAcF,EAAO,IAEzB,IAAMG,EAAQ,IAAI/D,EAAKgE,MAAM,GAAI,CAC/B7D,SAAUyD,EACVK,OAAQ,IAAIjE,EAAKkE,KAAK,GAAI,MAG5BH,EAAMI,SAASjE,GACf6D,EAAMK,WAAN,wBACU3C,EADV,sCAEgBpE,IAAOgH,SAFvB,mBAIArF,EAAIsF,WAAWP,K,mCASf,OAFIpF,KAAKV,MADPkD,UAAapB,KAGHf,KAAI,SAACT,EAAMgG,GAErB,IAAIC,EAAW,GAOf,OALEA,EADED,EAAQ,EACC,OAEA,OAASA,EAAQ,GAI5B,0BAAMrF,IAAKX,EAAMpB,UAAW,CAACE,IAAOoH,IAAKpH,IAAOmH,IAAWjH,KAAK,MAC7DgB,Q,+BAMC,IAAD,EAeHI,KAAKV,MAbPiD,EAFK,EAELA,UAFK,IAGLC,UACEM,EAJG,EAIHA,UACA5B,EALG,EAKHA,MACAC,EANG,EAMHA,MACAuB,EAPG,EAOHA,SACAC,EARG,EAQHA,KACAE,EATG,EASHA,MACAD,EAVG,EAUHA,SACAM,EAXG,EAWHA,WACAE,EAZG,EAYHA,YAEFC,EAdK,EAcLA,WAEF,OACE,yBAAK7E,UAAWE,IAAOgC,MAErB,kBAAC,IAAD,CACElC,UAAWE,IAAOqH,UAClBtH,aAAc,CAAC,uBAAG8B,IAAI,QAAQ/B,UAAU,0BAEvCsE,GAIH,yBAAKtE,UAAWE,IAAOsH,QACnBzD,EAKA,GAJA,kBAAC,IAAD,CAAU0D,UAAQ,EAACC,UAAQ,EAACC,iBAAkB,KAC3CnG,KAAKoG,kBAQZ,yBAAK5H,UAAWE,IAAO6F,MACrB,wBAAI/F,UAAWE,IAAO2H,WAAYnF,GAClC,kBAAC,IAAD,CAAM1C,UAAWE,IAAO0C,MACtB,kBAAC,IAAKkF,KAAN,KAAYtG,KAAKuG,eAGnB,kBAAC,IAAD,CAAM/H,UAAWE,IAAO8H,WACtB,kBAAC,IAAKF,KAAN,CAAW9H,UAAWE,IAAO+H,eAC3B,6BACGtF,EACD,0BAAM3C,UAAWE,IAAOgI,OAAxB,YAEF,8CAEF,kBAAC,IAAKJ,KAAN,CAAW9H,UAAWE,IAAO+H,eAC3B,6BAAM/D,GACN,8CAEF,kBAAC,IAAK4D,KAAN,CAAW9H,UAAWE,IAAO+H,eAC3B,6BAAM9D,EAAN,gBACA,+CAIJ,kBAAC,IAAD,CAAMnE,UAAWE,IAAOiI,UAAWC,MAAM,SACvC,kBAAC,IAAKN,KAAN,KACE,6BACE,0BAAM9H,UAAWE,IAAOwC,OAAxB,sBADF,gBAIA,6BACE,0BAAM1C,UAAWE,IAAOwC,OAAxB,sBACC2B,IAGL,kBAAC,IAAKyD,KAAN,KACE,6BACE,0BAAM9H,UAAWE,IAAOwC,OAAxB,sBACC0B,EAAShE,KAAK,WAEjB,6BACE,0BAAMJ,UAAWE,IAAOwC,OAAxB,sBADF,+BAQN,yBAAK1C,UAAWE,IAAO2B,KACrB,yBAAK7B,UAAWE,IAAOmI,UAAvB,qBAEE,8BAAO/D,IAET,yBAAKtE,UAAWE,IAAOoI,aAAc3H,GAAG,OAAxC,iBAMF,yBAAKX,UAAWE,IAAOqI,OACrB,yBAAKvI,UAAWE,IAAOsI,YAAvB,4BAIuB,IAAtB9D,EAAW+D,OACV,yBAAKzI,UAAWE,IAAOwI,YAAvB,4BAEA,kBAAC,IAAD,CAAchH,KAAMgD,KAKxB,yBAAK1E,UAAWE,IAAOyI,KACrB,yBAAK3I,UAAWE,IAAOsI,YAAvB,4BACA,6BACE,yBAAKxI,UAAWE,IAAO0I,SACrB,yBAAK5I,UAAWE,IAAO2I,MACrB,yBAAKtG,IAAKC,IAAW,kBAAmB+D,IAAI,iBAC5C,yBAAKvG,UAAWE,IAAO4I,SACrB,mDACA,yBAAK9I,UAAWE,IAAO6I,UACrB,uBAAG/I,UAAU,uBADf,oCAMJ,0BAAMA,UAAWE,IAAO8I,SAAxB,uBAGF,yBAAKhJ,UAAWE,IAAO+I,UACpBrE,GAAe,0CAMtB,yBAAK5E,UAAWE,IAAOgJ,WACrB,yBAAKlJ,UAAWE,IAAOsI,YAAvB,4BACA,yBAAKxI,UAAWE,IAAOiJ,OACpB7G,EAAgBT,KAAI,SAAAT,GAAI,OACvB,kBAAC,IAAD,iBAAeA,EAAf,CAAqBW,IAAKX,EAAKT,WAMrC,kBAAC,IAAD,CAAMX,UAAWE,IAAOkJ,aACtB,kBAAC,IAAKtB,KAAN,CAAW7F,QAAST,KAAKsD,gBACvB,yBACEvC,IACEC,KAAYqC,EAAa,gBAAkB,mBAE7C7E,UAAWE,IAAOmJ,YAClB9C,IAAI,iBAEN,0BAAMvG,UAAWE,IAAOoJ,UACrBzE,EAAa,qBAAQ,iBAG1B,kBAAC,IAAKiD,KAAN,iCACA,kBAAC,IAAKA,KAAN,KACE,uBAAGxB,KAAK,mBAAmBtG,UAAWE,IAAOqJ,WAA7C,mC,GAxY6BnH","file":"static/js/4.3f886b96.chunk.js","sourcesContent":["import React from 'react'\r\n\r\nimport { NavBar } from 'antd-mobile'\r\n\r\n// 导入 withRouter 高阶组件\r\nimport { withRouter } from 'react-router-dom'\r\n\r\n// 导入 props 校验的包\r\nimport PropTypes from 'prop-types'\r\n\r\n// 导入样式\r\n// import './index.scss'\r\nimport styles from './index.module.css'\r\n\r\n// 添加 className 和 rightContent（导航栏右侧内容） 属性\r\nfunction NavHeader({\r\n  children,\r\n  history,\r\n  onLeftClick,\r\n  className,\r\n  rightContent\r\n}) {\r\n  // 默认点击行为\r\n  const defaultHandler = () => history.go(-1)\r\n\r\n  return (\r\n    <NavBar\r\n      className={[styles.navBar, className || ''].join(' ')}\r\n      mode=\"light\"\r\n      icon={<i className=\"iconfont icon-back\" />}\r\n      onLeftClick={onLeftClick || defaultHandler}\r\n      rightContent={rightContent}\r\n    >\r\n      {children}\r\n    </NavBar>\r\n  )\r\n}\r\n\r\n// 添加props校验\r\nNavHeader.propTypes = {\r\n  children: PropTypes.string.isRequired,\r\n  onLeftClick: PropTypes.func,\r\n  className: PropTypes.string,\r\n  rightContent: PropTypes.array\r\n}\r\n\r\n// withRouter(NavHeader) 函数的返回值也是一个组件\r\nexport default withRouter(NavHeader)\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"navBar\":\"NavHeader_navBar__2SDxf\"};","import React, { Component } from 'react'\r\n\r\nimport styles from './index.module.css'\r\n\r\n// 所有房屋配置项\r\nconst HOUSE_PACKAGE = [\r\n  {\r\n    id: 1,\r\n    name: '衣柜',\r\n    icon: 'icon-wardrobe'\r\n  },\r\n  {\r\n    id: 2,\r\n    name: '洗衣机',\r\n    icon: 'icon-wash'\r\n  },\r\n  {\r\n    id: 3,\r\n    name: '空调',\r\n    icon: 'icon-air'\r\n  },\r\n  {\r\n    id: 4,\r\n    name: '天然气',\r\n    icon: 'icon-gas'\r\n  },\r\n  {\r\n    id: 5,\r\n    name: '冰箱',\r\n    icon: 'icon-ref'\r\n  },\r\n  {\r\n    id: 6,\r\n    name: '暖气',\r\n    icon: 'icon-Heat'\r\n  },\r\n  {\r\n    id: 7,\r\n    name: '电视',\r\n    icon: 'icon-vid'\r\n  },\r\n  {\r\n    id: 8,\r\n    name: '热水器',\r\n    icon: 'icon-heater'\r\n  },\r\n  {\r\n    id: 9,\r\n    name: '宽带',\r\n    icon: 'icon-broadband'\r\n  },\r\n  {\r\n    id: 10,\r\n    name: '沙发',\r\n    icon: 'icon-sofa'\r\n  }\r\n]\r\n\r\n/* \r\n  该组件的两种功能：\r\n  1 根据传入的 list 展示房屋配置列表（房源详情页面）\r\n    <HousePackage list={['衣柜', '洗衣机']} />\r\n  2 从所有配置列表中选择房屋配置（发布房源页面）\r\n    <HousePackage select onSelect={selectedItems => {...}} />\r\n*/\r\nclass HousePackage extends Component {\r\n  state = {\r\n    // 选中名称\r\n    selectedNames: []\r\n  }\r\n\r\n  // 根据id切换选中状态\r\n  toggleSelect = name => {\r\n    const { selectedNames } = this.state\r\n    let newSelectedNames\r\n\r\n    // 判断该项是否选中\r\n    if (selectedNames.indexOf(name) > -1) {\r\n      // 选中：从数组中删除选中项，也就是保留未选中项\r\n      newSelectedNames = selectedNames.filter(item => item !== name)\r\n    } else {\r\n      // 未选中：添加到数组中\r\n      newSelectedNames = [...selectedNames, name]\r\n    }\r\n\r\n    // 传递给父组件\r\n    this.props.onSelect(newSelectedNames)\r\n\r\n    this.setState({\r\n      selectedNames: newSelectedNames\r\n    })\r\n  }\r\n\r\n  // 渲染列表项\r\n  renderItems() {\r\n    const { selectedNames } = this.state\r\n    // select 的值为 true 表示 选择房屋配置；false 表示仅展示房屋列表\r\n    // list 表示要展示的列表项\r\n    const { select, list } = this.props\r\n\r\n    let data\r\n    // 如果传了 select 表示：选择 房屋配置\r\n    // 如果没传 select 表示：展示 房屋配置 列表\r\n    if (select) {\r\n      data = HOUSE_PACKAGE\r\n    } else {\r\n      // 展示房屋配置列表\r\n      // 从所有的列表项中过滤出要展示的（list）列表项\r\n      data = HOUSE_PACKAGE.filter(v => list.includes(v.name))\r\n    }\r\n\r\n    return data.map(item => {\r\n      // 判断该项是否选中\r\n      const isSelected = selectedNames.indexOf(item.name) > -1\r\n\r\n      return (\r\n        <li\r\n          key={item.id}\r\n          className={[styles.item, isSelected ? styles.active : ''].join(' ')}\r\n          onClick={select && (() => this.toggleSelect(item.name))}\r\n        >\r\n          <p>\r\n            <i className={`iconfont ${item.icon} ${styles.icon}`} />\r\n          </p>\r\n          {item.name}\r\n        </li>\r\n      )\r\n    })\r\n  }\r\n\r\n  render() {\r\n    return <ul className={styles.root}>{this.renderItems()}</ul>\r\n  }\r\n}\r\n\r\n// 属性默认值，防止在使用该组件时，不传 onSelect 报错\r\nHousePackage.defaultProps = {\r\n  onSelect: () => {}\r\n}\r\n\r\nexport default HousePackage\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"HousePackage_root__1_K0N\",\"item\":\"HousePackage_item__CJMJB\",\"active\":\"HousePackage_active__1PfDS\",\"icon\":\"HousePackage_icon__aHbgv\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"HouseDetail_root__QYr05\",\"slides\":\"HouseDetail_slides__3G6Wo\",\"navHeader\":\"HouseDetail_navHeader__2fbz6\",\"info\":\"HouseDetail_info__GK4rL\",\"infoTitle\":\"HouseDetail_infoTitle__2rcsE\",\"tags\":\"HouseDetail_tags__3Ekz8\",\"tag\":\"HouseDetail_tag__1SCb2\",\"tag1\":\"HouseDetail_tag1__3G75R\",\"tag2\":\"HouseDetail_tag2__Fd73P\",\"tag3\":\"HouseDetail_tag3__32jEd\",\"infoPrice\":\"HouseDetail_infoPrice__TNw3s\",\"infoPriceItem\":\"HouseDetail_infoPriceItem__2rX25\",\"month\":\"HouseDetail_month__o-be-\",\"infoBasic\":\"HouseDetail_infoBasic__2819_\",\"title\":\"HouseDetail_title__1ybsu\",\"map\":\"HouseDetail_map__2R4uU\",\"mapTitle\":\"HouseDetail_mapTitle__rx6kd\",\"mapContainer\":\"HouseDetail_mapContainer__1aA8r\",\"mapArrow\":\"HouseDetail_mapArrow__Puike\",\"houseTitle\":\"HouseDetail_houseTitle__2IU_T\",\"about\":\"HouseDetail_about__T9IfA\",\"set\":\"HouseDetail_set__B2Jfb\",\"titleEmpty\":\"HouseDetail_titleEmpty__2XDB9\",\"contact\":\"HouseDetail_contact__38lT6\",\"user\":\"HouseDetail_user__5NdM-\",\"useInfo\":\"HouseDetail_useInfo__4Ime6\",\"userAuth\":\"HouseDetail_userAuth__2AFSv\",\"userMsg\":\"HouseDetail_userMsg__3ik7t\",\"descText\":\"HouseDetail_descText__Fliw-\",\"recommend\":\"HouseDetail_recommend__3aJat\",\"items\":\"HouseDetail_items__3ffLD\",\"fixedBottom\":\"HouseDetail_fixedBottom__3ovgF\",\"favorite\":\"HouseDetail_favorite__15VUQ\",\"favoriteImg\":\"HouseDetail_favoriteImg__3tbcU\",\"telephone\":\"HouseDetail_telephone__3YMuj\"};","import React, { Component } from 'react'\r\n\r\nimport { Carousel, Flex, Modal, Toast } from 'antd-mobile'\r\n\r\nimport NavHeader from '../../components/NavHeader'\r\nimport HouseItem from '../../components/HouseItem'\r\nimport HousePackage from '../../components/HousePackage'\r\n\r\n// import { BASE_URL } from '../../utils/url'\r\n// import { API } from '../../utils/api'\r\nimport { isAuth, BASE_URL, API } from '../../utils'\r\n\r\nimport styles from './index.module.css'\r\n\r\n// 猜你喜欢\r\nconst recommendHouses = [\r\n  {\r\n    id: 1,\r\n    src: BASE_URL + '/img/message/1.png',\r\n    desc: '72.32㎡/南 北/低楼层',\r\n    title: '安贞西里 3室1厅',\r\n    price: 4500,\r\n    tags: ['随时看房']\r\n  },\r\n  {\r\n    id: 2,\r\n    src: BASE_URL + '/img/message/2.png',\r\n    desc: '83㎡/南/高楼层',\r\n    title: '天居园 2室1厅',\r\n    price: 7200,\r\n    tags: ['近地铁']\r\n  },\r\n  {\r\n    id: 3,\r\n    src: BASE_URL + '/img/message/3.png',\r\n    desc: '52㎡/西南/低楼层',\r\n    title: '角门甲4号院 1室1厅',\r\n    price: 4300,\r\n    tags: ['集中供暖']\r\n  }\r\n]\r\n\r\n// 百度地图\r\nconst BMap = window.BMap\r\n\r\nconst labelStyle = {\r\n  position: 'absolute',\r\n  zIndex: -7982820,\r\n  backgroundColor: 'rgb(238, 93, 91)',\r\n  color: 'rgb(255, 255, 255)',\r\n  height: 25,\r\n  padding: '5px 10px',\r\n  lineHeight: '14px',\r\n  borderRadius: 3,\r\n  boxShadow: 'rgb(204, 204, 204) 2px 2px 2px',\r\n  whiteSpace: 'nowrap',\r\n  fontSize: 12,\r\n  userSelect: 'none'\r\n}\r\n\r\nconst alert = Modal.alert\r\n\r\nexport default class HouseDetail extends Component {\r\n  state = {\r\n    // 数据加载中状态\r\n    isLoading: false,\r\n\r\n    // 房屋详情\r\n    houseInfo: {\r\n      // 房屋图片\r\n      houseImg: [],\r\n      // 标题\r\n      title: '',\r\n      // 标签\r\n      tags: [],\r\n      // 租金\r\n      price: 0,\r\n      // 房型\r\n      roomType: '',\r\n      // 房屋面积\r\n      size: 0,\r\n      // 朝向\r\n      oriented: [],\r\n      // 楼层\r\n      floor: '',\r\n      // 小区名称\r\n      community: '',\r\n      // 地理位置\r\n      coord: {\r\n        latitude: '39.928033',\r\n        longitude: '116.529466'\r\n      },\r\n      // 房屋配套\r\n      supporting: [],\r\n      // 房屋标识\r\n      houseCode: '',\r\n      // 房屋描述\r\n      description: ''\r\n    },\r\n\r\n    // 表示房源是否收藏\r\n    isFavorite: false\r\n  }\r\n\r\n  componentDidMount() {\r\n    // 获取配置好的路由参数：\r\n    // console.log('路由参数对象：', this.props.match.params)\r\n    // console.log(this.props)\r\n\r\n    // 获取房屋数据\r\n    this.getHouseDetail()\r\n\r\n    // 检查房源是否收藏\r\n    this.checkFavorite()\r\n  }\r\n\r\n  // 检查房源是否收藏：\r\n  async checkFavorite() {\r\n    const isLogin = isAuth()\r\n\r\n    if (!isLogin) {\r\n      // 没有登录\r\n      return\r\n    }\r\n\r\n    // 已登录\r\n    const { id } = this.props.match.params\r\n    const res = await API.get(`/user/favorites/${id}`)\r\n\r\n    const { status, body } = res.data\r\n    if (status === 200) {\r\n      // 表示请求已经成功，需要更新 isFavorite 的值\r\n      this.setState({\r\n        isFavorite: body.isFavorite\r\n      })\r\n    }\r\n  }\r\n\r\n  /* \r\n    收藏房源：\r\n\r\n    1 给收藏按钮绑定单击事件，创建方法 handleFavorite 作为事件处理程序。\r\n    2 调用 isAuth 方法，判断是否登录。\r\n    3 如果未登录，则使用 Modal.alert 提示用户是否去登录。\r\n    4 如果点击取消，则不做任何操作。\r\n    5 如果点击去登录，就跳转到登录页面，同时传递 state（登录后，再回到房源收藏页面）。\r\n    \r\n    6 根据 isFavorite 判断，当前房源是否收藏。\r\n    7 如果未收藏，就调用添加收藏接口，添加收藏。\r\n    8 如果已收藏，就调用删除收藏接口，去除收藏。\r\n\r\n    alert('提示', '登录后才能收藏房源，是否去登录?', [\r\n      { text: '取消' },\r\n      {\r\n        text: '去登录',\r\n        onPress: () => {}\r\n      }\r\n    ])\r\n  */\r\n\r\n  handleFavorite = async () => {\r\n    const isLogin = isAuth()\r\n    const { history, location, match } = this.props\r\n\r\n    if (!isLogin) {\r\n      // 未登录\r\n      return alert('提示', '登录后才能收藏房源，是否去登录?', [\r\n        { text: '取消' },\r\n        {\r\n          text: '去登录',\r\n          // 使用 replace 方法，解决登录后返回详情页面，再点击左上角返回按钮时\r\n          // 需要点击两次的问题\r\n          // onPress: () => history.push('/login', { from: location })\r\n          onPress: () => history.replace('/login', { from: location })\r\n        }\r\n      ])\r\n    }\r\n\r\n    // 已登录\r\n    const { isFavorite } = this.state\r\n    const { id } = match.params\r\n\r\n    if (isFavorite) {\r\n      // 已收藏，应该删除收藏\r\n      const res = await API.delete(`/user/favorites/${id}`)\r\n      // console.log(res)\r\n      this.setState({\r\n        isFavorite: false\r\n      })\r\n\r\n      if (res.data.status === 200) {\r\n        // 提示用户取消收藏\r\n        Toast.info('已取消收藏', 1, null, false)\r\n      } else {\r\n        // token 超时\r\n        Toast.info('登录超时，请重新登录', 2, null, false)\r\n      }\r\n    } else {\r\n      // 未收藏，应该添加收藏\r\n      const res = await API.post(`/user/favorites/${id}`)\r\n      // console.log(res)\r\n      if (res.data.status === 200) {\r\n        // 提示用户收藏成功\r\n        Toast.info('已收藏', 1, null, false)\r\n        this.setState({\r\n          isFavorite: true\r\n        })\r\n      } else {\r\n        // token 超时\r\n        Toast.info('登录超时，请重新登录', 2, null, false)\r\n      }\r\n    }\r\n  }\r\n\r\n  // 获取房屋详细信息\r\n  async getHouseDetail() {\r\n    const { id } = this.props.match.params\r\n\r\n    // 开启loading\r\n    this.setState({\r\n      isLoading: true\r\n    })\r\n\r\n    const res = await API.get(`/houses/${id}`)\r\n\r\n    // console.log(res.data.body)\r\n\r\n    this.setState({\r\n      houseInfo: res.data.body,\r\n      isLoading: false\r\n    })\r\n\r\n    const { community, coord } = res.data.body\r\n\r\n    // 渲染地图\r\n    this.renderMap(community, coord)\r\n  }\r\n\r\n  // 渲染轮播图结构\r\n  renderSwipers() {\r\n    const {\r\n      houseInfo: { houseImg }\r\n    } = this.state\r\n\r\n    return houseImg.map(item => (\r\n      <a key={item} href=\"http://itcast.cn\">\r\n        <img src={BASE_URL + item} alt=\"\" />\r\n      </a>\r\n    ))\r\n  }\r\n\r\n  // 渲染地图\r\n  renderMap(community, coord) {\r\n    const { latitude, longitude } = coord\r\n\r\n    const map = new BMap.Map('map')\r\n    const point = new BMap.Point(longitude, latitude)\r\n    map.centerAndZoom(point, 17)\r\n\r\n    const label = new BMap.Label('', {\r\n      position: point,\r\n      offset: new BMap.Size(0, -36)\r\n    })\r\n\r\n    label.setStyle(labelStyle)\r\n    label.setContent(`\r\n      <span>${community}</span>\r\n      <div class=\"${styles.mapArrow}\"></div>\r\n    `)\r\n    map.addOverlay(label)\r\n  }\r\n\r\n  // 渲染标签\r\n  renderTags() {\r\n    const {\r\n      houseInfo: { tags }\r\n    } = this.state\r\n\r\n    return tags.map((item, index) => {\r\n      // 如果标签数量超过3个，后面的标签就都展示位第三个标签的样式\r\n      let tagClass = ''\r\n      if (index > 2) {\r\n        tagClass = 'tag3'\r\n      } else {\r\n        tagClass = 'tag' + (index + 1)\r\n      }\r\n\r\n      return (\r\n        <span key={item} className={[styles.tag, styles[tagClass]].join(' ')}>\r\n          {item}\r\n        </span>\r\n      )\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      isLoading,\r\n      houseInfo: {\r\n        community,\r\n        title,\r\n        price,\r\n        roomType,\r\n        size,\r\n        floor,\r\n        oriented,\r\n        supporting,\r\n        description\r\n      },\r\n      isFavorite\r\n    } = this.state\r\n    return (\r\n      <div className={styles.root}>\r\n        {/* 导航栏 */}\r\n        <NavHeader\r\n          className={styles.navHeader}\r\n          rightContent={[<i key=\"share\" className=\"iconfont icon-share\" />]}\r\n        >\r\n          {community}\r\n        </NavHeader>\r\n\r\n        {/* 轮播图 */}\r\n        <div className={styles.slides}>\r\n          {!isLoading ? (\r\n            <Carousel autoplay infinite autoplayInterval={5000}>\r\n              {this.renderSwipers()}\r\n            </Carousel>\r\n          ) : (\r\n            ''\r\n          )}\r\n        </div>\r\n\r\n        {/* 房屋基础信息 */}\r\n        <div className={styles.info}>\r\n          <h3 className={styles.infoTitle}>{title}</h3>\r\n          <Flex className={styles.tags}>\r\n            <Flex.Item>{this.renderTags()}</Flex.Item>\r\n          </Flex>\r\n\r\n          <Flex className={styles.infoPrice}>\r\n            <Flex.Item className={styles.infoPriceItem}>\r\n              <div>\r\n                {price}\r\n                <span className={styles.month}>/月</span>\r\n              </div>\r\n              <div>租金</div>\r\n            </Flex.Item>\r\n            <Flex.Item className={styles.infoPriceItem}>\r\n              <div>{roomType}</div>\r\n              <div>房型</div>\r\n            </Flex.Item>\r\n            <Flex.Item className={styles.infoPriceItem}>\r\n              <div>{size}平米</div>\r\n              <div>面积</div>\r\n            </Flex.Item>\r\n          </Flex>\r\n\r\n          <Flex className={styles.infoBasic} align=\"start\">\r\n            <Flex.Item>\r\n              <div>\r\n                <span className={styles.title}>装修：</span>\r\n                精装\r\n              </div>\r\n              <div>\r\n                <span className={styles.title}>楼层：</span>\r\n                {floor}\r\n              </div>\r\n            </Flex.Item>\r\n            <Flex.Item>\r\n              <div>\r\n                <span className={styles.title}>朝向：</span>\r\n                {oriented.join('、')}\r\n              </div>\r\n              <div>\r\n                <span className={styles.title}>类型：</span>普通住宅\r\n              </div>\r\n            </Flex.Item>\r\n          </Flex>\r\n        </div>\r\n\r\n        {/* 地图位置 */}\r\n        <div className={styles.map}>\r\n          <div className={styles.mapTitle}>\r\n            小区：\r\n            <span>{community}</span>\r\n          </div>\r\n          <div className={styles.mapContainer} id=\"map\">\r\n            地图\r\n          </div>\r\n        </div>\r\n\r\n        {/* 房屋配套 */}\r\n        <div className={styles.about}>\r\n          <div className={styles.houseTitle}>房屋配套</div>\r\n          {/* <HousePackage list={supporting} /> */}\r\n          {/* <div className=\"title-empty\">暂无数据</div> */}\r\n\r\n          {supporting.length === 0 ? (\r\n            <div className={styles.titleEmpty}>暂无数据</div>\r\n          ) : (\r\n            <HousePackage list={supporting} />\r\n          )}\r\n        </div>\r\n\r\n        {/* 房屋概况 */}\r\n        <div className={styles.set}>\r\n          <div className={styles.houseTitle}>房源概况</div>\r\n          <div>\r\n            <div className={styles.contact}>\r\n              <div className={styles.user}>\r\n                <img src={BASE_URL + '/img/avatar.png'} alt=\"头像\" />\r\n                <div className={styles.useInfo}>\r\n                  <div>王女士</div>\r\n                  <div className={styles.userAuth}>\r\n                    <i className=\"iconfont icon-auth\" />\r\n                    已认证房主\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <span className={styles.userMsg}>发消息</span>\r\n            </div>\r\n\r\n            <div className={styles.descText}>\r\n              {description || '暂无房屋描述'}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* 推荐 */}\r\n        <div className={styles.recommend}>\r\n          <div className={styles.houseTitle}>猜你喜欢</div>\r\n          <div className={styles.items}>\r\n            {recommendHouses.map(item => (\r\n              <HouseItem {...item} key={item.id} />\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* 底部收藏按钮 */}\r\n        <Flex className={styles.fixedBottom}>\r\n          <Flex.Item onClick={this.handleFavorite}>\r\n            <img\r\n              src={\r\n                BASE_URL + (isFavorite ? '/img/star.png' : '/img/unstar.png')\r\n              }\r\n              className={styles.favoriteImg}\r\n              alt=\"收藏\"\r\n            />\r\n            <span className={styles.favorite}>\r\n              {isFavorite ? '已收藏' : '收藏'}\r\n            </span>\r\n          </Flex.Item>\r\n          <Flex.Item>在线咨询</Flex.Item>\r\n          <Flex.Item>\r\n            <a href=\"tel:400-618-4000\" className={styles.telephone}>\r\n              电话预约\r\n            </a>\r\n          </Flex.Item>\r\n        </Flex>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n"],"sourceRoot":""}