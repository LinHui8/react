(this.webpackJsonphaoke=this.webpackJsonphaoke||[]).push([[8],{641:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(15),i=a(85),s=a(642),c=a.n(s);t.a=Object(i.f)((function(e){var t=e.children,a=e.history,n=e.onLeftClick,i=e.className,s=e.rightContent;return r.a.createElement(o.i,{className:[c.a.navBar,i||""].join(" "),mode:"light",icon:r.a.createElement("i",{className:"iconfont icon-back"}),onLeftClick:n||function(){return a.go(-1)},rightContent:s},t)}))},642:function(e,t,a){e.exports={navBar:"NavHeader_navBar__2SDxf"}},692:function(e,t,a){e.exports={map:"Map_map__RBO9Q",container:"Map_container__rxpnF",bubble:"Map_bubble__1UYQ5",name:"Map_name__16xho",rect:"Map_rect__3r1vQ",arrow:"Map_arrow__Ecylr",housename:"Map_housename__3FBHa",housenum:"Map_housenum__1DSjS",houseList:"Map_houseList__2ciqT",show:"Map_show__1ZjTo",titleWrap:"Map_titleWrap__3lM3f",listTitle:"Map_listTitle__3ND7Z",titleMore:"Map_titleMore__2CS1v",houseItems:"Map_houseItems__2XTLO"}},706:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return L}));var n=a(21),r=a.n(n),o=a(39),i=a(28),s=a(29),c=a(31),l=a(30),u=a(32),p=a(0),h=a.n(p),d=a(95),v=a(87),m=a(15),f=a(65),_=a(641),y=a(217),w=a(692),b=a.n(w),g=window.BMap,k={cursor:"pointer",border:"0px solid rgb(255, 0, 0)",padding:"0px",whiteSpace:"nowrap",fontSize:"12px",color:"rgb(255, 255, 255)",textAlign:"center"},L=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={housesList:[],isShowList:!1},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.initMap()}},{key:"initMap",value:function(){var e=this,t=JSON.parse(localStorage.getItem("hkzf_city")),a=t.label,n=t.value,i=new g.Map("container");this.map=i,(new g.Geocoder).getPoint(a,function(){var t=Object(o.a)(r.a.mark((function t(a){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a&&(i.centerAndZoom(a,11),i.addControl(new g.NavigationControl),i.addControl(new g.ScaleControl),e.renderOverlays(n));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),a),i.addEventListener("movestart",(function(){e.state.isShowList&&e.setState({isShowList:!1})}))}},{key:"renderOverlays",value:function(){var e=Object(o.a)(r.a.mark((function e(t){var a,n,o,i,s,c=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,m.o.loading("\u52a0\u8f7d\u4e2d...",0,null,!1),e.next=4,d.a.get("/area/map?id=".concat(t));case 4:a=e.sent,m.o.hide(),n=a.data.body,o=this.getTypeAndZoom(),i=o.nextZoom,s=o.type,n.forEach((function(e){c.createOverlays(e,i,s)})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),m.o.hide();case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getTypeAndZoom",value:function(){var e,t,a=this.map.getZoom();return a>=10&&a<12?(e=13,t="circle"):a>=12&&a<14?(e=15,t="circle"):a>=14&&a<16&&(t="rect"),{nextZoom:e,type:t}}},{key:"createOverlays",value:function(e,t,a){var n=e.coord,r=n.longitude,o=n.latitude,i=e.label,s=e.count,c=e.value,l=new g.Point(r,o);"circle"===a?this.createCircle(l,i,s,c,t):this.createRect(l,i,s,c)}},{key:"createCircle",value:function(e,t,a,n,r){var o=this,i=new g.Label("",{position:e,offset:new g.Size(-35,-35)});i.id=n,i.setContent('\n      <div class="'.concat(b.a.bubble,'">\n        <p class="').concat(b.a.name,'">').concat(t,"</p>\n        <p>").concat(a,"\u5957</p>\n      </div>\n    ")),i.setStyle(k),i.addEventListener("click",(function(){o.renderOverlays(n),o.map.centerAndZoom(e,r),setTimeout((function(){o.map.clearOverlays()}),0)})),this.map.addOverlay(i)}},{key:"createRect",value:function(e,t,a,n){var r=this,o=new g.Label("",{position:e,offset:new g.Size(-50,-28)});o.id=n,o.setContent('\n      <div class="'.concat(b.a.rect,'">\n        <span class="').concat(b.a.housename,'">').concat(t,'</span>\n        <span class="').concat(b.a.housenum,'">').concat(a,'\u5957</span>\n        <i class="').concat(b.a.arrow,'"></i>\n      </div>\n    ')),o.setStyle(k),o.addEventListener("click",(function(e){r.getHousesList(n);var t=e.changedTouches[0];r.map.panBy(window.innerWidth/2-t.clientX,(window.innerHeight-330)/2-t.clientY)})),this.map.addOverlay(o)}},{key:"getHousesList",value:function(){var e=Object(o.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,m.o.loading("\u52a0\u8f7d\u4e2d...",0,null,!1),e.next=4,d.a.get("/houses?cityId=".concat(t));case 4:a=e.sent,m.o.hide(),this.setState({housesList:a.data.body.list,isShowList:!0}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),m.o.hide();case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"renderHousesList",value:function(){var e=this;return this.state.housesList.map((function(t){return h.a.createElement(y.a,{onClick:function(){return e.props.history.push("/detail/".concat(t.houseCode))},key:t.houseCode,src:f.a+t.houseImg,title:t.title,desc:t.desc,tags:t.tags,price:t.price})}))}},{key:"render",value:function(){return h.a.createElement("div",{className:b.a.map},h.a.createElement(_.a,null,"\u5730\u56fe\u627e\u623f"),h.a.createElement("div",{id:"container",className:b.a.container}),h.a.createElement("div",{className:[b.a.houseList,this.state.isShowList?b.a.show:""].join(" ")},h.a.createElement("div",{className:b.a.titleWrap},h.a.createElement("h1",{className:b.a.listTitle},"\u623f\u5c4b\u5217\u8868"),h.a.createElement(v.b,{className:b.a.titleMore,to:"/home/list"},"\u66f4\u591a\u623f\u6e90")),h.a.createElement("div",{className:b.a.houseItems},this.renderHousesList())))}}]),t}(h.a.Component)}}]);
//# sourceMappingURL=8.c6c17e98.chunk.js.map